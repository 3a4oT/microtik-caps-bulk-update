# CAPsMAN Bulk Upgrade (ac + ax, RouterOS ‚â• 7.16) ‚Äî README (UA)

–¶–µ–π —Å–∫—Ä–∏–ø—Ç –æ–Ω–æ–≤–ª—é—î **–∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä** MikroTik (CAPsMAN) —Ç–∞ **CAP-–ø—Ä–∏—Å—Ç—Ä–æ—ó** –¥–æ **–æ—Å—Ç–∞–Ω–Ω—å–æ—ó** –≤–µ—Ä—Å—ñ—ó RouterOS –Ω–∞ **–ø–æ—Ç–æ—á–Ω–æ–º—É** –∫–∞–Ω–∞–ª—ñ –æ–Ω–æ–≤–ª–µ–Ω—å –æ–¥–Ω—ñ—î—é –∫–æ–º–∞–Ω–¥–æ—é. –ü—ñ–¥—Ç—Ä–∏–º—É—î –∑–º—ñ—à–∞–Ω–µ –æ—Ç–æ—á–µ–Ω–Ω—è **ac** (ARM, legacy `/caps-man`) —ñ **ax** (ARM64, –Ω–æ–≤–∏–π `/interface wifi capsman`).

–°–∫—Ä–∏–ø—Ç **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤–∏–∑–Ω–∞—á–∞—î** –¥–æ—Å—Ç—É–ø–Ω—ñ —É—Ç–∏–ª—ñ—Ç–∏, –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î –ø–æ—Ç—Ä—ñ–±–Ω—ñ –ø–∞–∫–µ—Ç–∏ —Ç–∞ –ø–æ–∫–∞–∑—É—î –∑—Ä—É—á–Ω–µ **UPGRADE SUMMARY** –∑ –∫–æ–º–∞–Ω–¥–∞–º–∏ –≤ –∫—ñ–Ω—Ü—ñ.

üîó **–°–∫—Ä–∏–ø—Ç**: [`cap-bulk-upgrade.rsc`](cap-bulk-upgrade.rsc)

## üõ† –í—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—è (–Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ)

1. –í—ñ–¥–∫—Ä–∏–π—Ç–µ **WinBox / WebFig** ‚Üí **System ‚Üí Scripts ‚Üí +**.  
2. **Name**: `cap-bulk-upgrade`.  
3. –£–≤—ñ–º–∫–Ω—ñ—Ç—å Policies: **read, write, test, policy, ftp**.  
4. –°–∫–æ–ø—ñ—é–π—Ç–µ –∫–æ–¥ —Å–∫—Ä–∏–ø—Ç–∞: **[cap-bulk-upgrade.rsc](cap-bulk-upgrade.rsc)** ‚Üí –í—Å—Ç–∞–≤—Ç–µ –≤ RouterOS ‚Üí **OK**.  
   üìù *–ü–æ—Ä–∞–¥–∞: –ù–∞—Ç–∏—Å–Ω—ñ—Ç—å –Ω–∞ –ª—ñ–Ω–∫, –ø–æ—Ç—ñ–º Ctrl+A ‚Üí Ctrl+C –¥–ª—è –∫–æ–ø—ñ—é–≤–∞–Ω–Ω—è –≤—Å—å–æ–≥–æ —Å–∫—Ä–∏–ø—Ç–∞.*

---

## ‚ñ∂Ô∏è –ó–∞–ø—É—Å–∫ (–Ω–∞ –æ—Å–Ω–æ–≤–Ω–æ–º—É –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ)

- –ß–µ—Ä–µ–∑ WinBox: **System ‚Üí Scripts ‚Üí cap-bulk-upgrade ‚Üí Run Script**  

–ê–ë–û 

- –ß–µ—Ä–µ–∑ —Ç–µ—Ä–º—ñ–Ω–∞–ª:
   ```rsc
   /system script run cap-bulk-upgrade
   ```

---

---

## üöÄ –ú–æ–∂–ª–∏–≤–æ—Å—Ç—ñ

- –í–∏–∑–Ω–∞—á–∞—î `latest-version` –≤—ñ–¥ update-—Å–µ—Ä–≤–µ—Ä–∞ (–∫–∞–Ω–∞–ª **–Ω–µ** –∑–º—ñ–Ω—é—î—Ç—å—Å—è).
- –ü–µ—Ä–µ–≤—ñ—Ä—è—î –≤–µ—Ä—Å—ñ—é **–∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞** —ñ **–∫–æ–∂–Ω–æ–≥–æ CAP-–∞** (ac —ñ ax –æ–∫—Ä–µ–º–æ).
- –Ø–∫—â–æ **–≤—Å—ñ –Ω–∞ –æ—Å—Ç–∞–Ω–Ω—ñ–π –≤–µ—Ä—Å—ñ—ó** ‚Äî **–Ω—ñ—á–æ–≥–æ –Ω–µ –∑–∞–≤–∞–Ω—Ç–∞–∂—É—î** —ñ –∑–∞–≤–µ—Ä—à—É—î —Ä–æ–±–æ—Ç—É.
- –Ø–∫—â–æ –ø–æ—Ç—Ä—ñ–±–Ω–µ –æ–Ω–æ–≤–ª–µ–Ω–Ω—è:
  - –ü–µ—Ä–µ–≤—ñ—Ä—è—î **–≤—ñ–ª—å–Ω–∏–π –ø—Ä–æ—Å—Ç—ñ—Ä** –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ; —è–∫—â–æ –º–∞–ª–æ ‚Äî –∑—É–ø–∏–Ω—è—î—Ç—å—Å—è –∑ —á—ñ—Ç–∫–∏–º –ø–æ–≤—ñ–¥–æ–º–ª–µ–Ω–Ω—è–º.
  - –ó–∞–≤–∞–Ω—Ç–∞–∂—É—î **—Ä—ñ–≤–Ω–æ —Ç—ñ –ø–∞–∫–µ—Ç–∏**, —â–æ –ø–æ—Ç—Ä—ñ–±–Ω—ñ –¥–ª—è –ø—Ä–∏—Å—É—Ç–Ω—ñ—Ö –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä:
    - –ë–∞–∑–∞: `routeros-<ver>-arm.npk`, `routeros-<ver>-arm64.npk`
    - –î—Ä–∞–π–≤–µ—Ä–∏ Wi-Fi: `wifi-qcom-ac-<ver>-arm.npk` (ac), `wireless-<ver>-arm.npk` (legacy –¥–ª—è ac), `wifi-qcom-<ver>-arm64.npk` (ax)
    - –î–æ–¥–∞—Ç–∫–æ–≤–æ: `calea-<ver>-arm(.npk)` —ñ `-arm64` (–∑–∞–ø–æ–±—ñ–≥–∞—î –ø–æ–º–∏–ª—Ü—ñ *‚Äúno such file‚Äù*, —è–∫—â–æ CAP –º–∞—î CALEA)
- –û–Ω–æ–≤–ª—é—î **–ª–∏—à–µ –∑–∞—Å—Ç–∞—Ä—ñ–ª—ñ CAP-–∏** (–≤–æ–Ω–∏ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂—É—é—Ç—å—Å—è —Å–∞–º—ñ).
- –û–Ω–æ–≤–ª–µ–Ω–Ω—è **–∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞** ‚Äî –∑–∞–≤–∂–¥–∏ –≤–∏–º–∞–≥–∞—î —Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è (–±–µ–∑–ø–µ—á–Ω–æ).
- –ü—ñ—Å–ª—è –ø–∞—É–∑–∏ –≤–∏–¥–∞–ª—è—î –≤—Å—ñ `.npk` –∑ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞.
- –õ–æ–≥–∏ **–∞–Ω–≥–ª—ñ–π—Å—å–∫–æ—é** —É —Ç–µ—Ä–º—ñ–Ω–∞–ª —Ç–∞ **System ‚Üí Log**.

---

## ‚úÖ –í–∏–º–æ–≥–∏

- RouterOS **7.16+** –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ (–ø–µ—Ä–µ–≤—ñ—Ä–µ–Ω–æ –Ω–∞ 7.19.4).
- CAP-–∏ –≤–∏–¥–∏–º—ñ –ø—ñ–¥ `/caps-man` (ac) —Ç–∞/–∞–±–æ `/interface wifi capsman` (ax).
- –ù–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ –ø—Ä–∞—Ü—é—î **DNS/–Ü–Ω—Ç–µ—Ä–Ω–µ—Ç**.
- –ü–æ–ª—ñ—Ç–∏–∫–∏ —Å–∫—Ä–∏–ø—Ç–∞: **read, write, test, policy, ftp** (WinBox ‚Üí System ‚Üí Scripts ‚Üí –≤–∞—à —Å–∫—Ä–∏–ø—Ç ‚Üí Policies).

---

## ‚öôÔ∏è –ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è (–Ω–∞ –ø–æ—á–∞—Ç–∫—É —Å–∫—Ä–∏–ø—Ç–∞)

- `:local minFreePerPkgBytes 15000000` ‚Äî –æ—Ü—ñ–Ω–∫–∞ –ø–æ—Ç—Ä—ñ–±–Ω–æ–≥–æ –º—ñ—Å—Ü—è (‚âà15 –ú—ñ–ë –Ω–∞ –ø–∞–∫–µ—Ç, –≤–∏–∫–æ—Ä–∏—Å—Ç–æ–≤—É—î—Ç—å—Å—è –≤ –ø—ñ–¥—Ä–∞—Ö—É–Ω–∫—É –ø–µ—Ä–µ–¥ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º).

- `:local cleanupDelay "120s"` ‚Äî —á–∞—Å –Ω–∞ –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è –ø–∞–∫–µ—Ç—ñ–≤ CAP-–∞–º–∏ –ø–µ—Ä–µ–¥ –≤–∏–¥–∞–ª–µ–Ω–Ω—è–º `.npk`.

## üìã –ü–æ–≤–µ–¥—ñ–Ω–∫–∞ —Å–∫—Ä–∏–ø—Ç–∞

- **CAP-–∏** –æ–Ω–æ–≤–ª—é—é—Ç—å—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ** (–±–µ–∑–ø–µ—á–Ω–æ, —Å–∞–º—ñ –∫–µ—Ä—É—é—Ç—å –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è–º).
- **–ö–æ–Ω—Ç—Ä–æ–ª–µ—Ä** –∑–∞–≤–∂–¥–∏ –≤–∏–º–∞–≥–∞—î **—Ä—É—á–Ω–æ–≥–æ –ø–µ—Ä–µ–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è** –¥–ª—è –±–µ–∑–ø–µ–∫–∏.
- –í –∫—ñ–Ω—Ü—ñ —Å–∫—Ä–∏–ø—Ç –ø–æ–∫–∞–∑—É—î **UPGRADE SUMMARY** –∑ —É—Å—ñ–º–∞ –ø–æ—Ç—Ä—ñ–±–Ω–∏–º–∏ –∫–æ–º–∞–Ω–¥–∞–º–∏.
- –î–ª—è –æ–Ω–æ–≤–ª–µ–Ω–Ω—è –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞ –ø—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç—ñ—Ç—å: `/system reboot` (RouterOS –∞–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–∏–π .npk —Ñ–∞–π–ª).

## üì∫ –ü—Ä–∏–∫–ª–∞–¥ –≤–∏–≤–æ–¥—É

```
cap-bulk-upgrade: Available utilities - legacy caps-man: false, wifi capsman: true
cap-bulk-upgrade: latest=7.19.4  controller=7.17.2
cap-bulk-upgrade: discovered wifi CAPs: 0
fetch routeros-7.19.4-arm64.npk
[...–∑–∞–≤–∞–Ω—Ç–∞–∂–µ–Ω–Ω—è...]
cap-bulk-upgrade: controller needs upgrade (7.17.2 -> 7.19.4), package downloaded
cap-bulk-upgrade: no CAPs detected
cap-bulk-upgrade: finished

=================================================================
UPGRADE SUMMARY
=================================================================

Controller: 7.17.2 -> 7.19.4 (READY - manual reboot required)

To complete controller upgrade, copy and run:
/system reboot

RouterOS will automatically install: routeros-7.19.4-arm64.npk

NOTE: Controller reboot does NOT affect CAP operations.

CAPs: No CAPs detected

=================================================================
```


## üß∞ –£—Å—É–Ω–µ–Ω–Ω—è –Ω–µ—Å–ø—Ä–∞–≤–Ω–æ—Å—Ç–µ–π

- **‚Äúcannot detect latest-version‚Äù** ‚Üí –ø–µ—Ä–µ–≤—ñ—Ä—Ç–µ DNS/–Ü–Ω—Ç–µ—Ä–Ω–µ—Ç –Ω–∞ –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä—ñ:
   ```rsc
   /ping 8.8.8.8 count=3
   /ip dns print
   ```
- **‚Äúinsufficient space ‚Ä¶‚Äù** ‚Üí –∑–≤—ñ–ª—å–Ω—ñ—Ç—å –º—ñ—Å—Ü–µ —É **Files** (–≤–∏–¥–∞–ª—ñ—Ç—å –∑–∞–π–≤–µ), –ø–æ–≤—Ç–æ—Ä—ñ—Ç—å –∑–∞–ø—É—Å–∫.
- **–ù–∞ CAP –ø–æ–º–∏–ª–∫–∞ ‚Äúfailed to download ‚Ä¶ .npk, no such file‚Äù** ‚Üí –Ω–∞ CAP –≤—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–π –¥–æ–¥–∞—Ç–∫–æ–≤–∏–π –ø–∞–∫–µ—Ç (–Ω–∞–ø—Ä–∏–∫–ª–∞–¥, `calea`). –î–æ–¥–∞–π—Ç–µ –≤—ñ–¥–ø–æ–≤—ñ–¥–Ω–∏–π `.npk` –¥–ª—è –π–æ–≥–æ –∞—Ä—Ö—ñ—Ç–µ–∫—Ç—É—Ä–∏ (`-arm` –∞–±–æ `-arm64`) —É **Files** –∫–æ–Ω—Ç—Ä–æ–ª–µ—Ä–∞ —Ç–∞ –ø–æ–≤—Ç–æ—Ä—ñ—Ç—å.